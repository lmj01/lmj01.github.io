# 观点

## [工业AI难以落地的根因和出路探讨](https://www.chaspark.com/#/hotspots/1202309462079717376?isOriginal=1)

- 核心工业数据CAD的数学基础——边界表示法(B-rep)的脆弱性，而突破之道亦在于理论层面的创新
- 从数学视角看，当前AI技术的核心基础可以归结为流形分布定则（Manifold Distribution Principle）和概率分布变换两大概念。自然数据（如图像、视频、三维模型）通常呈现出高度的结构化特征，这些特征在数学上可以被理解为高维空间中的低维流形。具体而言，每一个数据样本都可以被视为原始数据空间中的一个点，而整个数据集则构成了该空间中的一个稠密点云，这片点云位于某个低维流形附近，并遵循特定的概率分布规律。

### AI的数学基础

#### 流形分布定则及其数学内涵
- 流形分布定则的数学表达式源于对自然数据本质的观察。
- 从微分几何角度看，流形分布定则揭示了自然数据的内置规律性：
    - 数据点云不会填满整个高维空间，而是聚集在一个低维子流形附件
    - AI应用中，通过编码器encoder讲数据从高维空间映射到低维的隐空间latent space实现流形的降维表示
    - 隐空间中的点与数据流形上的点构成一一对应关系，
    - 而正则性理论保证了编码映射和解码映射的连续性和光滑性，即隐空间到数据流形的映射是微分同胚的。
#### 概率分布

- 生成模型的核心任务是在隐空间构造一个变换映射，在数学上可表述为：
    - 给定隐空间中的两个概率分布，一个简单的先验分布，一个数据分布
    - 找到一个变换，使得将先验分布变换映射到数据分布中。
- 主流生成模型有
    1. 扩散模型diffusion model，通过随机微分方程逐渐向数据添加噪声，将数据分布转换为高斯分布，然后学习逆过程以从噪声中生成数据
    2. 流模型flow-based model，通过一些列可逆变换将简单分布转为数据分布
    3. 基于最优传输理论optimal transport，通过求解蒙日-安培Monge-Ampere equation来寻找一个传输映射
- 各有优缺点
    1. 训练稳定但速度慢
    2. 需要严格的架构设计以保证可逆性
    3. 提供了良好的几何解释，但求解复杂。最优传输映射可以通过Brenier理论归结为蒙日-安培方程的弱解Alexandrov解，该方程的存在性和唯一性已有严格的数学证明。
### 生成模型的数学理论与技术挑战
### CAD数据的表示困境与隐式几何的崛起

#### 边界表示法B-Rep的基础与脆弱性
在计算机辅助设计（CAD）领域，边界表示法（Boundary Representation，B-Rep）是当前的主流技术，它通过描述物体的边界来定义三维实体，即使用曲面、曲线和顶点等参数化基元及其拓扑关系来表示三维形状。B-Rep模型的核心在于其精确的边界表示，使得它在工程制造中具有重要价值。然而，B-Rep表示具有固有的几何、拓扑和命名的脆弱性，这些脆弱性导致在迭代优化过程中容易"崩溃"。

- 首先，在几何层面，B-Rep模型依赖于浮点数表示，而浮点数的精度有限，在几何运算（如求交、投影）中容易产生误差。OpenCASCADE中B-Rep体模型最小建模精度为1.e-7，即使设置的容差小于1.e-7，查询容差时系统也会返回1.e-7。这意味着如果以米为单位，要对纳米尺度的物体建模，在OpenCASCADE中是无法实现的。

- 其次，在拓扑层面，B-Rep模型中的点、线、面之间的拓扑关系是显式存储的，缺少一个边或者面就会导致模型显示异常甚至无法使用。拓扑关系的维护极其困难，尤其是在布尔运算等复杂几何操作中，拓扑一致性的保持是一个巨大挑战。在布尔运算中，为了提高稳定性，引入了Fuzzy容差的概念，通过扩大容差范围来处理接触情况。

- 第三，在命名层面，B-Rep模型中的几何元素（点、边、面）通常通过指针或索引来引用，当模型经过一系列变换后，这些引用容易失效，导致模型更新失败。这种脆弱性使得B-Rep模型在参数化设计和优化迭代中极其不稳定，少了一个边都显示不出来，更无法进行后续的仿真分析。

#### 隐式几何表示的数学基础与优势

相比B-Rep表示，隐式几何表示（Implicit Geometric Representation）通过函数（通常是标量值函数）的等值面来定义几何形状，即一个形状可以表示为 { p ∈ R³ | f(p) = 0 }。常见的隐式表示包括符号距离函数（Signed Distance Function，SDF）和函数表示（Function representation，F-rep）。

隐式表示的核心数学基础是代数几何中的水平集方法（Level Set Method）和变分法。
符号距离函数是某度量空间中一个区域的函数，它决定了空间中任意给定点到该区域边界的距离，并且由点在该区域内外确定其距离的正负号（当点位于区域边界上时距离为零）。
符号距离函数能够有效地刻画空间形状，在图像处理、计算几何、曲线曲面重构等领域被广泛应用。

隐式几何表示相对于B-Rep表示有几个关键优势：
- 布尔运算的鲁棒性：隐式表示可以通过函数的最大值、最小值等操作实现稳健的布尔运算，不会出现B-Rep表示中的奇异情况。
- 拓扑变化的灵活性：隐式表示可以自然地处理拓扑变化，如从单一物体分裂为多个物体，或多个物体合并为一个物体。
- 多尺度分析的适应性：隐式表示便于进行多尺度分析，因为函数可以在不同分辨率下进行采样和计算。

在实际应用中，面向三维打印的符号距离函数表示的隐式几何模型构建方法已经被广泛研究。
基于Eikonal方程建立符号距离场的稀疏优化模型，使用样条函数来光滑逼近符号距离场，即使在输入采样点没有法向信息情况下，仍然能获得很好的符号距离场重建。

### 未来发展方向：AI与几何模型的融合