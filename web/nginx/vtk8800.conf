user meiji users; # 与whoami 看到的用户是一致的
worker_processes 1;
events { worker_connections 1024; }
http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile      on; # WSL2 建议打开

    server {
        listen       8800;
        server_name  localhost;

        # ① 指定根目录
        root /home/meiji/repo/vtk-js/Data;   # ← 改成你的绝对路径
        # Windows 示例：root C:/vtk-data;

        # ② 关闭日志，省屏
        #access_log off;
        #error_log  /dev/stderr;

        # 静态资源，任意深度目录都能访问
        location / {
            autoindex on; # 允许列目录 即时没有index.html
            autoindex_exact_size off; # 可读性大小
            try_files $uri $uri/ =404;
        }

        # ③ 关键：对 .vt? 文件禁用 gzip 并声明 identity
        location ~* \.(vtp|vtu|vtr|vti|vtm)$ {
            gzip off;
            add_header Content-Encoding identity;
        }

        # ④ 允许跨域（可选，前端用 localhost:5173 时需要）
        add_header Access-Control-Allow-Origin *;
    }
}
